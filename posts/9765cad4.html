<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://babybluue.github.io/posts/9765cad4"><link rel="manifest" href="/manifest.webmanifest"><link rel="apple-touch-icon" sizes="192x192" href="/images/appleicon"><link rel="apple-touch-startup-image" media="(device-width: 750px) and (device-height:1334px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/images/launch"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="babyblue"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1f1f1f"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="color-scheme" content="light dark"><link rel="icon" href="/images/favicon.ico"><meta name="description" content="通过对象解构赋值在循环里取对象特定的属性 "><meta name="keywords" content="blog,博客,程序员,记录,学习,网站 "><title>JavaScript 备忘录</title><link rel="stylesheet" href="/style/style.css"><link rel="stylesheet" href="/style/highlight.css" media="none" onload='this.media="all"'><link rel="stylesheet" href="/style/fancybox.css" media="none" onload='this.media="all"'><script type="text/javascript">var currentPath=window.location.pathname,targetUrl="https://didmax.pages.dev";window.location.href=targetUrl+currentPath</script><script>localStorage.theme&&document.documentElement.setAttribute("data-theme",localStorage.theme)</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TMJ0G5Z2NR"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TMJ0G5Z2NR")</script><script>document.onreadystatechange=()=>{const t=document.querySelector(".loading-bar");700<document.body.clientWidth&&(t.style.background="#91C4E2","interactive"==document.readyState&&(t.style.transition="width 1.4s ease-in-out",t.style.width="67%"),"complete"==document.readyState&&(t.style.transition="width 0.3s ease-in-out",t.style.width="100%",setTimeout(()=>{t.setAttribute("style","transition:width 0s;width:0;background:''")},500)))}</script><meta name="generator" content="Hexo 5.4.2"></head><body class="scroll-bar"><div class="loading-bar"></div><div class="progress-bar"></div><main><header><nav><ul class="nav-button"><li></li><li></li><li></li></ul><div class="nav-bar"><ul><span class="close-button">×</span><div class="nav-avatar"><a href="/" aria-label="index"><img src="/images/avatar.png" class="avatar" alt="avatar"></a></div><li><a href="/archives/">Archive</a></li><li><a href="/notes/">Notes</a></li><li><a href="/articles/">Articles</a></li><li><a href="mailto:kerrismith19786@gmail.com" rel="external nofollow noreferrer">Contact</a></li></ul></div></nav></header><div class="post-main"><article><div class="post-card"><div class="header-title">JavaScript 备忘录</div><div class="header-info">2022.05.13 Fri <span style="color:#f08080">updated</span></div><div class="card-content"><ul><li><p>通过对象解构赋值在循环里取对象特定的属性</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Data</span> &#123;<br>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span><br>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span><br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">students</span>: <span class="hljs-title class_">Data</span> = []<br>students.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">&#123; id &#125;</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(id)<br>&#125;)<br></code></pre></td></tr></table></figure></li></ul><span id="more"></span><ul><li><p>JS 可以直接使用 id 选择器的名字</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;vae&quot;</span>&gt;</span>大家好,我是vae<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(vae)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>localStorage 存放和读取值的两种方式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&quot;theme&quot;</span>,<span class="hljs-string">&#x27;dark&#x27;</span>)<br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;theme&#x27;</span>)<br><br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-property">theme</span>=<span class="hljs-string">&#x27;dark&#x27;</span><br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-property">theme</span><br></code></pre></td></tr></table></figure></li><li><p>原生 js 修改 css 样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;demo&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;font-size: 20px&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>hello wrold<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> demo = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.demo&#x27;</span>)</span><br><span class="language-javascript">    <span class="hljs-comment">//1</span></span><br><span class="language-javascript">    demo.<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">&#x27;lightgray&#x27;</span></span><br><span class="language-javascript">    <span class="hljs-comment">//2</span></span><br><span class="language-javascript">    demo.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(<span class="hljs-string">&#x27;background&#x27;</span>, <span class="hljs-string">&#x27;lightcoral&#x27;</span>)</span><br><span class="language-javascript">    <span class="hljs-comment">//3</span></span><br><span class="language-javascript">    demo.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">&#x27;font-size:10px;color:blue;background:lightblue&#x27;</span></span><br><span class="language-javascript">    <span class="hljs-comment">//4</span></span><br><span class="language-javascript">    demo.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;style&#x27;</span>, <span class="hljs-string">&#x27;background:lightgreen;font-size:30px&#x27;</span>)</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>every() 方法</p><p>every() 方法测试一个数组内的所有元素是否都能通过某个指定函数的测试。它返回一个布尔值。</p><blockquote><p>注意：若收到一个空数组，此方法在一切情况下都会返回 true。</p></blockquote></li><li><p>some() 方法<br>some() 方法测试数组中是不是至少有 1 个元素通过了被提供的函数测试。它返回的是一个 Boolean 类型的值。</p><blockquote><p>如果用一个空数组进行测试，在任何情况下它返回的都是 false。</p></blockquote></li><li><p>清除所有的计时器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">1000</span>; i++) &#123;<br>  <span class="hljs-built_in">clearTimeout</span>(i);<br>  <span class="hljs-built_in">clearInterval</span>(i)<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>slice()方法<br>arr.slice([begin[, end]]) 返回一个新的数组对象，是一个由 begin 和 end 决定的原数组的浅拷贝（包括 begin，不包括 end）。原始数组不会被改变。<br>begin 和 end 的取值按照索引，从 0 开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> animals = [<span class="hljs-string">&#x27;ant&#x27;</span>, <span class="hljs-string">&#x27;bison&#x27;</span>, <span class="hljs-string">&#x27;camel&#x27;</span>, <span class="hljs-string">&#x27;duck&#x27;</span>, <span class="hljs-string">&#x27;elephant&#x27;</span>];<br><br><span class="hljs-comment">//不指明begin和end会返回原始数组的拷贝值</span><br>animals.<span class="hljs-title function_">slice</span>() <span class="hljs-comment">//[&#x27;ant&#x27;, &#x27;bison&#x27;, &#x27;camel&#x27;, &#x27;duck&#x27;, &#x27;elephant&#x27;];</span><br><br><br><span class="hljs-comment">//指明begin，从该索引值开始取到最后一个元素</span><br>animals.<span class="hljs-title function_">slice</span>(<span class="hljs-number">3</span>)<span class="hljs-comment">//[ &#x27;duck&#x27;, &#x27;elephant&#x27; ]</span><br><span class="hljs-comment">//begin为负数时，按照指定的倒数位置取到最后一个元素</span><br>animals.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">2</span>)<span class="hljs-comment">//[ &#x27;duck&#x27;, &#x27;elephant&#x27; ]</span><br>animals.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">1</span>)<span class="hljs-comment">//[&#x27;elepant&#x27;]</span><br><br><span class="hljs-comment">//指明end，从begin取到end之前索引的元素，不包括end位置</span><br>animals.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<span class="hljs-comment">//[ &#x27;ant&#x27; ]</span><br>animals.<span class="hljs-title function_">slice</span>(<span class="hljs-number">3</span>,<span class="hljs-number">5</span>)<span class="hljs-comment">//[ &#x27;duck&#x27;, &#x27;elephant&#x27; ]</span><br><span class="hljs-comment">//如果end是负数，并且倒数位置取到的元素仍在begin之后且存在，正常截取否则返回空数组</span><br>animals.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>)<span class="hljs-comment">//[ &#x27;ant&#x27;, &#x27;bison&#x27;, &#x27;camel&#x27;, &#x27;duck&#x27; ]</span><br>anmails.<span class="hljs-title function_">slice</span>(<span class="hljs-number">3</span>,-<span class="hljs-number">1</span>)<span class="hljs-comment">//[ &#x27;duck&#x27; ]</span><br></code></pre></td></tr></table></figure></li><li><p>splice()方法<br>array.splice(start[, deleteCount[, item1[, item2[, ...]]]]) 通过删除或替换现有元素或者原地添加新的元素来修改数组,并以数组形式返回被修改的内容。此方法会改变原数组。</p><p>start​<br>指定修改的开始位置（从 0 计数）。如果超出了数组的长度，则从数组末尾开始添加内容；如果是负值，则表示从数组末位开始的第几位；如果负数的绝对值大于数组的长度，则表示开始位置为第 0 位。</p><p>deleteCount 可选<br>整数，表示要移除的数组元素的个数。<br>如果 deleteCount 大于 start 之后的元素的总数，则从 start 后面的元素都将被删除（含第 start 位）。<br>如果 deleteCount 被省略了，或者超出 start 之后元素的数量，那么 start 之后数组的所有元素都会被删除。<br>如果 deleteCount 是 0 或者负数，则不移除元素。这种情况下，至少应添加一个新元素。</p><p>item1, item2, ... 可选<br>要添加进数组的元素,从 start 位置开始。如果不指定，则 splice() 将只删除数组元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> months = [<span class="hljs-string">&#x27;Jan&#x27;</span>, <span class="hljs-string">&#x27;March&#x27;</span>, <span class="hljs-string">&#x27;April&#x27;</span>, <span class="hljs-string">&#x27;June&#x27;</span>];<br><br><span class="hljs-comment">//省略删除数量，将会删除索引后的整个数组</span><br>months.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>) <span class="hljs-comment">//返回值 [&#x27;Jan&#x27;, &#x27;March&#x27;, &#x27;April&#x27;, &#x27;June&#x27;]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(months) <span class="hljs-comment">//[]</span><br>months.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// 返回值 [&#x27;March&#x27;, &#x27;April&#x27;, &#x27;June&#x27;]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(months) <span class="hljs-comment">//[&#x27;Jan&#x27;]</span><br><br>months.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;abc&#x27;</span>,<span class="hljs-string">&#x27;def&#x27;</span>,<span class="hljs-string">&#x27;ghi&#x27;</span>) <span class="hljs-comment">//返回值 []</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(months) <span class="hljs-comment">//[&#x27;abc&#x27;,&#x27;def&#x27;,&#x27;ghi&#x27;,&#x27;Jan&#x27;,&#x27;March&#x27;,&#x27;April&#x27;,&#x27;June&#x27;]</span><br><br>months.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;abc&#x27;</span>,<span class="hljs-string">&#x27;def&#x27;</span>) <span class="hljs-comment">//返回值 [ &#x27;March&#x27; ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(months) <span class="hljs-comment">// [&#x27;Jan&#x27;, ,&#x27;abc&#x27;,&#x27;def&#x27;,&#x27;April&#x27;, &#x27;June&#x27;]</span><br></code></pre></td></tr></table></figure></li><li><p>reduce()方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-comment">//语法</span><br>arr.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">previousValue, currentValue, currentIndex, array</span>) =&gt;</span> &#123; <span class="hljs-comment">/* ... */</span> &#125;, initialValue)<br><span class="hljs-comment">//previousValue上一次调用的返回值，如果是第一次调用并且没有指定初始值则为arr[0]</span><br><span class="hljs-comment">//currentValue当前处理的值，如果是第一次调用且没有指定初始值则为arr[1]</span><br><span class="hljs-comment">//currentIndex当前处理的索引，如果没有指定初始值，从索引1开始</span><br><br><span class="hljs-keyword">const</span> arrTest=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]<br>arrTest.<span class="hljs-title function_">reduct</span>(<span class="hljs-function">(<span class="hljs-params">prev,curr</span>)=&gt;</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(prev,curr))<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  1 2</span><br><span class="hljs-comment">  undefined 3</span><br><span class="hljs-comment">  ....</span><br><span class="hljs-comment">*/</span><br>arrTest.<span class="hljs-title function_">reduct</span>(<span class="hljs-function">(<span class="hljs-params">prev,curr</span>)=&gt;</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(prev,curr),<span class="hljs-string">&#x27;dd&#x27;</span>)<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  dd 1</span><br><span class="hljs-comment">  undefined 2</span><br><span class="hljs-comment">  ....</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">MDN-reduce</a></p></li><li><p>通过 reduce 将对象数组中某些属性值相同的对象去重</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs JS">  <span class="hljs-keyword">const</span> newOrder = orderData.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">previous, current, index</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (index == <span class="hljs-number">0</span>) &#123;<br>    previous.<span class="hljs-title function_">push</span>(current);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">const</span> &#123;name,contact,address &#125; = newData;<br>    <span class="hljs-keyword">const</span> lastOrder = previous.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">const</span> isSame=lastOrder[<span class="hljs-string">&#x27;name&#x27;</span>] == name &amp;&amp; lastOrder[<span class="hljs-string">&#x27;contact&#x27;</span>] == contact &amp;&amp; lastOrder[<span class="hljs-string">&#x27;address&#x27;</span>] == address<br>    <span class="hljs-keyword">if</span> (!isSame) &#123;<br>      previous.<span class="hljs-title function_">push</span>(newData);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> previous;<br>&#125;, []);<br></code></pre></td></tr></table></figure></li><li><p>如何使循环中的异步调用同步次序执行 async/await</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-string">&#x27;k&#x27;</span>];<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">test</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">2000</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr[i]);<br>  &#125;);<br>&#125;<br>&#125;;<br><span class="hljs-title function_">test</span>();<br></code></pre></td></tr></table></figure><p>在 forEach 和 map 中使用 async/await 无效，forEach 没有返回值，而 map 返回的是一个 promise 数组。<br>可以通过上面的例子写一个 sleep 函数，在代码里实现等待效果，前提是支持 async/await 形式。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> <span class="hljs-title function_">load</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) &#123;<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">sleep</span> = (<span class="hljs-params">time</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time));<br>&#125;;<br></code></pre></td></tr></table></figure></li><li><p>encodeURI()与 encodeURIComponent()</p><p>encodeURIComponent()转义除了 A-Z a-z 0-9 - _ . ! ~ * ' ( )的所有字符，而 encodeURI()会保留一些特殊和有意义的符合，以及数字字母。<br>一般 encodeURI()用来可以用来转义简单 URL，encodeURIComponent()用来转义 URL 复杂参数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">var</span> set1 = <span class="hljs-string">&quot;;,/?:@&amp;=+$&quot;</span>;  <span class="hljs-comment">// 保留字符</span><br><span class="hljs-keyword">var</span> set2 = <span class="hljs-string">&quot;-_.!~*&#x27;()&quot;</span>;   <span class="hljs-comment">// 不转义字符</span><br><span class="hljs-keyword">var</span> set3 = <span class="hljs-string">&quot;#&quot;</span>;           <span class="hljs-comment">// 数字标志</span><br><span class="hljs-keyword">var</span> set4 = <span class="hljs-string">&quot;ABC abc 123&quot;</span>; <span class="hljs-comment">// 字母数字字符和空格</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURI</span>(set1)); <span class="hljs-comment">// ;,/?:@&amp;=+$</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURI</span>(set2)); <span class="hljs-comment">// -\_.!~\*&#x27;()</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURI</span>(set3)); <span class="hljs-comment">// #</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURI</span>(set4)); <span class="hljs-comment">// ABC%20abc%20123 (空格被编码为 %20)</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURIComponent</span>(set1)); <span class="hljs-comment">// %3B%2C%2F%3F%3A%40%26%3D%2B%24</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURIComponent</span>(set2)); <span class="hljs-comment">// -\_.!~\*&#x27;()</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURIComponent</span>(set3)); <span class="hljs-comment">// %23</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">encodeURIComponent</span>(set4)); <span class="hljs-comment">// ABC%20abc%20123 (the space gets encoded as %20)</span><br></code></pre></td></tr></table></figure><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent">MDN-encodeURIComponet</a></p></li><li><p>JS 原生获取 URL 中的参数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> href=<span class="hljs-string">&#x27;https://www.youtube.com/watch?v=Ttf3CEsEwMQ&#x27;</span><br><span class="hljs-keyword">const</span> videoId=<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(href).<span class="hljs-property">searchParams</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;v&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(videoId) <span class="hljs-comment">// Ttf3CEsEwMQ</span><br></code></pre></td></tr></table></figure><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://developer.mozilla.org/zh-CN/docs/Web/API/URL/URL">MDN-URL()</a></p></li><li><p>JS 原生深拷贝方法 structuredClone()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> person1 = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zhou&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">43</span> &#125;;<br><span class="hljs-keyword">const</span> person2 = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;li&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">42</span>, <span class="hljs-attr">member</span>: person1 &#125;;<br><span class="hljs-keyword">const</span> person3 = <span class="hljs-title function_">structuredClone</span>(person2);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person3);<br>person1.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;wang&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2.<span class="hljs-property">member</span>); <span class="hljs-comment">// &#123;name: &#x27;wang&#x27;, age: 43&#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person3.<span class="hljs-property">member</span>); <span class="hljs-comment">// &#123;name: &#x27;zhou&#x27;, age: 43&#125;</span><br></code></pre></td></tr></table></figure><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://developer.mozilla.org/zh-CN/docs/Web/API/structuredClone">MDN-structuredClone()</a></p></li><li><p>字面量定义对象时，用表达式作为对象的属性名</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> keyName = <span class="hljs-string">&#x27;name&#x27;</span><br><br><span class="hljs-keyword">const</span> obj = &#123;<br>  [keyName]: <span class="hljs-string">&#x27;lijialong&#x27;</span>,<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>字符串与数字之间的转换</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> num = <span class="hljs-number">123</span><br><span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;123&#x27;</span><br><br>num + <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">//数字转字符串</span><br>+ str; <span class="hljs-comment">//字符串转数字</span><br><br></code></pre></td></tr></table></figure></li><li><p>可选链式操作符 optional chains (?.)</p><blockquote><p>可选链操作符 ( ?. ) 允许读取位于连接对象链深处的属性的值，而不必明确验证链中的每个引用是否有效。?. 操作符的功能类似于 . 链式操作符，不同之处在于，在引用为空 (nullish ) (null 或者 undefined) 的情况下不会引起错误，该表达式短路返回值是 undefined。与函数调用一起使用时，如果给定的函数不存在，则返回 undefined。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> person=&#123; <span class="hljs-attr">li</span>: &#123; sex : <span class="hljs-string">&#x27;man&#x27;</span> &#125; &#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">zhang</span>.<span class="hljs-property">sex</span>) <span class="hljs-comment">// Uncaught TypeError: Cannot read properties of undefined (reading &#x27;sex&#x27;)</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">zhang</span>?.<span class="hljs-property">sex</span>) <span class="hljs-comment">// undefined</span><br></code></pre></td></tr></table></figure></li><li><p>空值合并运算符 nullish coalescing operator (??)</p><blockquote><p>空值合并操作符（??）是一个逻辑操作符，当左侧的操作数为 null 或者 undefined 时，返回其右侧操作数，否则返回左侧操作数。<br>与逻辑或操作符（||）不同，逻辑或操作符会在左侧操作数为假值时返回右侧操作数。也就是说，如果使用 || 来为某些变量设置默认值，可能会遇到意料之外的行为。比如为假值（例如，'' 或 0）时</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">const</span> name = <span class="hljs-string">&#x27;&#x27;</span> || <span class="hljs-string">&#x27;lisi&#x27;</span> <span class="hljs-comment">// name = &#x27;lisi&#x27;</span><br><span class="hljs-keyword">const</span> name = <span class="hljs-string">&#x27;&#x27;</span> ?? <span class="hljs-string">&#x27;zhangsan&#x27;</span> <span class="hljs-comment">// name = &#x27;zhangsan&#x27;</span><br><br><span class="hljs-keyword">const</span> number = <span class="hljs-number">0</span> || <span class="hljs-number">1000</span> <span class="hljs-comment">// number = 1000</span><br><span class="hljs-keyword">const</span> number = <span class="hljs-number">0</span> ?? <span class="hljs-number">1000</span> <span class="hljs-comment">// number = 0</span><br></code></pre></td></tr></table></figure></li></ul><hr><p>参考链接:<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://markodenic.com/javascript-tips/">JavaScript Tip</a></p></div><div class="post-tags"><a href="/tags/JavaScript/">JavaScript </a><a href="/tags/%E5%A4%87%E5%BF%98%E5%BD%95/">备忘录</a></div></div></article><div class="post-pagination"><div class="prev-page"><a href="/posts/3ff28d3c" title="JavaScript操作Dom元素">JavaScript操作Dom元素</a></div><div class="next-page"><a href="/posts/daabaeac" title="Angular命令行 ">Angular命令行</a></div></div></div><svg t="1673947892053" class="top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9313" width="45" height="45"><path d="M535.12 442.432v210.016a16 16 0 0 1-16 16h-16.16a16 16 0 0 1-16-16V440.208l-32.88 32.864a16 16 0 0 1-11.312 4.688h-28.304a14.464 14.464 0 0 1-10.24-24.688l97.824-97.808a11.136 11.136 0 0 1 15.744 0l97.808 97.808a14.464 14.464 0 0 1-10.24 24.688h-28.288a16 16 0 0 1-11.312-4.688l-30.64-30.64zM512 800c159.056 0 288-128.944 288-288s-128.944-288-288-288-288 128.944-288 288 128.944 288 288 288z m0 48c-185.568 0-336-150.432-336-336s150.432-336 336-336 336 150.432 336 336-150.432 336-336 336z" p-id="9314"></path></svg><div class="tip disappear"><p>检测到页面内容有更新，是否刷新页面 <span class="positive-btn">是</span><span class="negative-btn">否</span></p></div></main><script src="/scripts/script.js" async></script><script async type="module">import{Fancybox}from"/scripts/fancybox.esm.js";Fancybox.bind('[data-fancybox="gallery"]',{Toolbar:{display:["fullscreen","download","close"]}})</script></body></html>